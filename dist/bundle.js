!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=7)}([function(t,e,s){"use strict";s.d(e,"b",function(){return i});var i,n=s(10),o=s(12),a=(s(13),s(14)),r=s(15),h=s(16),c=s(6);!function(t){t[t.MENU=0]="MENU",t[t.TANK_PLACING=1]="TANK_PLACING",t[t.TANK_MOVING=2]="TANK_MOVING",t[t.TANK_SELECTION=3]="TANK_SELECTION",t[t.TANK_SHOOTING=4]="TANK_SHOOTING"}(i||(i={}));e.a=class{constructor(t,e){this.canvas=t,this.context=e,this.player=new h.a,this.shared=new c.b,this.changeGameState(i.MENU)}changeGameState(t){switch(this.state=t,this.canvas.onmousedown=null,window.onmouseup=null,this.canvas.onmousemove=null,t){case i.MENU:this.action=new r.a(this,this.context),console.log("Initialising MENU");break;case i.TANK_PLACING:this.action=new o.a(this,this.context,this.player),console.log("Initialising TANK PLACING");break;case i.TANK_SELECTION:console.log("Initialising TANK SELECTION"),this.action=new a.a(this,this.context,this.player);break;case i.TANK_MOVING:console.log("Initialising TANK MOVEMENT"),this.action=new n.a(this,this.context,this.player);break;case i.TANK_SHOOTING:throw new Error("Not implemented yet");default:throw new Error("The game should never be stateless, something has gone terribly wrong")}this.action.addEventListeners(this.canvas)}clearCanvas(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)}}},function(t,e,s){"use strict";s.d(e,"b",function(){return i});var i,n=s(2);class o{constructor(){this.red=0,this.green=0,this.blue=0,this.alpha=1}toRGB(){return"rgb("+this.red+","+this.green+","+this.blue+")"}toRGBA(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"}set(t,e,s){this.red=t,this.green=e,this.blue=s}goYellow(){this.set(255,255,0)}goRed(){this.set(255,0,0)}goGreen(){this.set(0,255,0)}goBlue(){this.set(0,0,255)}goWhite(){this.set(255,255,255)}goBlack(){this.set(0,0,0)}next(){0!=this.red?this.goGreen():0!=this.green?this.goBlue():(this.blue,this.goRed())}}e.a=class{constructor(){this.mouse=new n.a,this.last=new n.a,this.color=new o}dot(t,e,s,i=!1,n=1){t.fillStyle=this.color.toRGBA(),t.lineWidth=n,t.beginPath(),t.arc(e.X,e.Y,s,0,2*Math.PI,!0),t.closePath(),t.fill(),i&&(t.strokeStyle=this.color.toRGBA(),t.stroke())}circle(t,e,s,i=!1,n=1){t.strokeStyle=this.color.toRGBA(),t.lineWidth=n,t.beginPath(),t.arc(e.X,e.Y,s,0,2*Math.PI,!0),t.closePath(),t.stroke(),i&&(t.strokeStyle=this.color.toRGBA(),t.stroke())}line(t,e,s=!0){-1==this.last.X&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y),t.strokeStyle=this.color.toRGBA(),t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(this.last.X,this.last.Y),t.lineTo(this.mouse.X,this.mouse.Y),t.lineWidth=e,t.stroke(),t.closePath(),s&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y)}updateMousePosition(t){t||(t=event),t.offsetX&&(this.mouse.X=t.offsetX,this.mouse.Y=t.offsetY)}updateTouchPosition(t){if(t||(t=event),t.touches&&1==t.touches.length){const e=t.touches[0];this.mouse.X=e.pageX-e.target.offsetLeft,this.mouse.Y=e.pageY-e.target.offsetTop}}},function(t){t[t.DRAWING=0]="DRAWING",t[t.STOPPED=1]="STOPPED"}(i||(i={}))},function(t,e,s){"use strict";class i{constructor(t=-1,e=-1){this.X=t,this.Y=e}copy(){return new i(this.X,this.Y)}}e.a=i},function(t,e,s){"use strict";var i=s(2);class n{constructor(t,e){this.position=new i.a(t,e)}draw(t,e){e.color.goBlack(),e.circle(t,this.position,n.DEFAULT_WIDTH)}highlight(t,e){e.color.goRed(),e.dot(t,this.position,n.DEFAULT_WIDTH+5,!0,5),e.color.goGreen(),e.circle(t,this.position,n.DEFAULT_MOVEMENT_RANGE),e.color.goBlack()}}e.a=n,n.DEFAULT_WIDTH=12,n.DEFAULT_MOVEMENT_RANGE=100,n.DEFAULT_MOVEMENT_LINE_WIDTH=3},function(t,e,s){"use strict";class i{}e.a=i,i.point=new class{dist2d(t,e){const s=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(Math.abs(s*s+i*i))}collide_circle(t,e,s){return!(this.dist2d(t,e)>s)}}},function(t,e,s){"use strict";e.a=class{constructor(t=5){this.limit=t,this.num_actions=0,this.num_actions=0}end(){return this.num_actions+=1,this.num_actions>=this.limit}next(){this.num_actions=0,this.turns+=1}}},function(t,e,s){"use strict";e.a=class{constructor(t,e){this.valid_position=!1,this.id=t,this.position=e}};e.b=class{constructor(){this.active=new i,this.next=new i}};class i{constructor(){this.resource=null,this.accessed=!1}set(t){this.resource=t,this.accessed=!1}available(){return!this.accessed&&null!==this.resource}get(){if(this.accessed)throw new Error("This single access object has already been accessed.");{const t=this.resource;return this.resource=null,t}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(8),n=s(9);window.Controls=i.a;var o="tanks-canvas";new n.a(o,window.innerWidth-32,.9*window.innerHeight)},function(t,e,s){"use strict";e.a=class{static toggle_w3_show(t){-1==t.className.indexOf("w3-show")?t.className+=" w3-show":t.className=t.className.replace(" w3-show","")}static w3_open(){document.getElementById("mySidebar").style.display="block",document.getElementById("myOverlay").style.display="block"}static w3_close(){document.getElementById("mySidebar").style.display="none",document.getElementById("myOverlay").style.display="none"}}},function(t,e,s){"use strict";var i=s(0);e.a=class{constructor(t,e,s){this.canvas=document.getElementById(t),this.setDOMResolution(e,s),this.events=new i.a(this.canvas,this.canvas.getContext("2d"))}showEvent(t,e,s){document.getElementById("debug-status").innerHTML=e+"times: "+s,event.preventDefault()}setDOMResolution(t,e){this.canvas.width=t,this.canvas.height=e}}},function(t,e,s){"use strict";var i=s(1),n=s(11),o=s(5),a=s(0),r=s(2),h=s(3);e.a=class{constructor(t,e,s){this.startMovement=(t=>{this.draw.last=new r.a(this.active.position.X,this.active.position.Y),this.draw.state=i.b.DRAWING,this.line.in(this.active.position,this.draw.mouse)&&this.validMove()}),this.endMovement=(t=>{this.draw.state=i.b.STOPPED,this.line.reset(),this.active.valid_position&&(this.player.tanks[this.active.id].position=this.draw.mouse.copy(),this.showUserWarning("")),this.redraw(this.player.tanks),this.controller.shared.next.set(a.b.TANK_MOVING),this.controller.changeGameState(a.b.TANK_SELECTION)}),this.drawMoveLine=(t=>{this.draw.updateMousePosition(t),this.draw.state==i.b.DRAWING&&(this.line.in(this.active.position,this.draw.mouse)?this.validMove():this.active.valid_position=!1)}),this.controller=t,this.context=e,this.player=s,this.draw=new i.a,this.line=new n.a(h.a.DEFAULT_MOVEMENT_RANGE),this.turn=new o.a,this.active=this.controller.shared.active.get()}addEventListeners(t){t.onmousedown=this.startMovement,t.onmousemove=this.drawMoveLine,window.onmouseup=this.endMovement}showUserWarning(t){document.getElementById("user-warning").innerHTML=t}validMove(){this.active.valid_position=!0,this.draw.line(this.context,h.a.DEFAULT_MOVEMENT_LINE_WIDTH)}redraw(t){this.controller.clearCanvas();for(const e of t)e.draw(this.context,this.draw)}}},function(t,e,s){"use strict";var i=s(4);e.a=class{constructor(t=200){this.limit=t,this.current=0}reset(){this.current=0}add(t,e){return this.current+=i.a.point.dist2d(t,e),this.current<=this.limit}in(t,e){return i.a.point.dist2d(t,e)<=this.limit}}},function(t,e,s){"use strict";var i=s(0),n=s(3),o=s(1),a=s(5);e.a=class{constructor(t,e,s){this.addTank=(t=>{this.draw.updateMousePosition(t);const e=new n.a(this.draw.mouse.X,this.draw.mouse.Y);e.player=this.player,this.player.tanks.push(e),e.draw(this.context,this.draw),this.turn.end()&&(this.controller.shared.next.set(i.b.TANK_MOVING),this.controller.changeGameState(i.b.TANK_SELECTION))}),this.controller=t,this.context=e,this.draw=new o.a,this.turn=new a.a,this.player=s}addEventListeners(t){t.onmousedown=this.addTank}}},function(t,e,s){"use strict";var i=s(0);e.a=class{constructor(t,e){this.someFunc=(()=>{console.log("Changing state from TANK SHOOTING to MENU"),this.controller.changeGameState(i.b.MENU)}),console.log("Initialising TANK SHOOTING"),this.controller=t,this.context=e}addEventListeners(t){t.addEventListener("mousedown",this.someFunc,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.someFunc,!1)}}},function(t,e,s){"use strict";var i=s(4),n=s(1),o=s(3),a=s(6);e.a=class{constructor(t,e,s){this.highlightTank=(t=>{this.draw.updateMousePosition(t);for(const[t,e]of this.player.tanks.entries())if(i.a.point.collide_circle(this.draw.mouse,e.position,o.a.DEFAULT_WIDTH)){e.highlight(this.context,this.draw),this.controller.shared.active.set(new a.a(t,e.position));break}}),this.mouseUp=(t=>{this.controller.shared.active.available()&&this.controller.changeGameState(this.controller.shared.next.get())}),this.controller=t,this.context=e,this.player=s,this.draw=new n.a}addEventListeners(t){t.onmousedown=this.highlightTank,window.onmouseup=this.mouseUp}}},function(t,e,s){"use strict";var i=s(0),n=s(1);class o{constructor(t,e){this.start_height=150,this.height_increment=70,this.final_height=-1,this.title=t,this.options=e}draw(t,e){const s=t.canvas.width,i=t.canvas.height;t.fillStyle="Black",t.fillRect(0,0,s,i),t.textAlign="center",t.fillStyle="rgb(135,206,250)",t.font="60px Georgia";let n=this.start_height;const o=s/2;t.fillText(this.title,o,n),t.fillStyle="White",t.font="30px Georgia";for(const[e,s]of this.options.entries())n+=this.height_increment,this.selected(e)?(t.fillStyle="Yellow",t.font="40px Georgia"):(t.fillStyle="White",t.font="30px Georgia"),t.fillText(s,o,n);this.final_height=n}selected(t){return this.selected_item===t}select(t){if(-1===this.final_height)throw new Error("The menu hasn't been drawn.");const e=this.height_increment/2;let s=this.final_height,i=this.options.length-1;for(;s>this.start_height;){if(t.Y>s-e)return void(this.selected_item=i);s-=this.height_increment,i-=1}}}e.a=class{constructor(t,e){this.selectMenuitem=(t=>{this.draw.updateMousePosition(t),this.menu.select(this.draw.mouse),this.menu.draw(this.context,this.draw)}),this.someFunc=(t=>{console.log("Changing state from MENU EVENT to TANK PLACING"),this.controller.clearCanvas(),this.controller.changeGameState(i.b.TANK_PLACING)}),this.controller=t,this.context=e,this.draw=new n.a,this.menu=new o("Tanks",["Start game","Potatoes","Apples","I","Choose","You","Pikachu"]),this.menu.draw(this.context,this.draw)}addEventListeners(t){t.onmousedown=this.someFunc,t.onmousemove=this.selectMenuitem}}},function(t,e,s){"use strict";e.a=class{constructor(){this.tanks=new Array}}}]);