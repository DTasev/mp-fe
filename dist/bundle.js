!function(t){var s={};function e(i){if(s[i])return s[i].exports;var n=s[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=s,e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},e.p="",e(e.s=7)}([function(t,s,e){"use strict";e.d(s,"b",function(){return i});var i,n=e(10),o=e(12),a=(e(13),e(14)),r=e(15),h=e(16),c=e(6);!function(t){t[t.MENU=0]="MENU",t[t.TANK_PLACING=1]="TANK_PLACING",t[t.TANK_MOVING=2]="TANK_MOVING",t[t.TANK_SELECTION=3]="TANK_SELECTION",t[t.TANK_SHOOTING=4]="TANK_SHOOTING"}(i||(i={}));s.a=class{constructor(t,s){this.canvas=t,this.context=s,this.player=new h.a,this.shared=new c.b,this.changeGameState(i.MENU)}changeGameState(t){switch(this.state=t,this.canvas.onmousedown=null,window.onmouseup=null,this.canvas.onmousemove=null,t){case i.MENU:this.action=new r.a(this,this.context),console.log("Initialising MENU");break;case i.TANK_PLACING:this.action=new o.a(this,this.context,this.player),console.log("Initialising TANK PLACING");break;case i.TANK_SELECTION:console.log("Initialising TANK SELECTION"),this.action=new a.a(this,this.context,this.player);break;case i.TANK_MOVING:console.log("Initialising TANK MOVEMENT"),this.action=new n.a(this,this.context,this.player);break;case i.TANK_SHOOTING:throw new Error("Not implemented yet");default:throw new Error("The game should never be stateless, something has gone terribly wrong")}this.action.addEventListeners(this.canvas)}clearCanvas(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)}}},function(t,s,e){"use strict";e.d(s,"b",function(){return i});var i,n=e(2);class o{constructor(){this.red=0,this.green=0,this.blue=0,this.alpha=1}toRGB(){return"rgb("+this.red+","+this.green+","+this.blue+")"}toRGBA(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"}set(t,s,e){this.red=t,this.green=s,this.blue=e}goYellow(){this.set(255,255,0)}goRed(){this.set(255,0,0)}goGreen(){this.set(0,255,0)}goBlue(){this.set(0,0,255)}goWhite(){this.set(255,255,255)}goBlack(){this.set(0,0,0)}next(){0!=this.red?this.goGreen():0!=this.green?this.goBlue():(this.blue,this.goRed())}}s.a=class{constructor(){this.mouse=new n.a,this.last=new n.a,this.color=new o}dot(t,s,e,i=!1,n=1){t.fillStyle=this.color.toRGBA(),t.lineWidth=n,t.beginPath(),t.arc(s.X,s.Y,e,0,2*Math.PI,!0),t.closePath(),t.fill(),i&&(t.strokeStyle=this.color.toRGBA(),t.stroke())}circle(t,s,e,i=!1,n=1){t.strokeStyle=this.color.toRGBA(),t.lineWidth=n,t.beginPath(),t.arc(s.X,s.Y,e,0,2*Math.PI,!0),t.closePath(),t.stroke(),i&&(t.strokeStyle=this.color.toRGBA(),t.stroke())}line(t,s,e=!0){-1==this.last.X&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y),t.strokeStyle=this.color.toRGBA(),t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(this.last.X,this.last.Y),t.lineTo(this.mouse.X,this.mouse.Y),t.lineWidth=s,t.stroke(),t.closePath(),e&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y)}updateMousePosition(t){t||(t=event),t.offsetX&&(this.mouse.X=t.offsetX,this.mouse.Y=t.offsetY)}updateTouchPosition(t){if(t||(t=event),t.touches&&1==t.touches.length){const s=t.touches[0];this.mouse.X=s.pageX-s.target.offsetLeft,this.mouse.Y=s.pageY-s.target.offsetTop}}},function(t){t[t.DRAWING=0]="DRAWING",t[t.STOPPED=1]="STOPPED"}(i||(i={}))},function(t,s,e){"use strict";class i{constructor(t=-1,s=-1){this.X=t,this.Y=s}copy(){return new i(this.X,this.Y)}}s.a=i},function(t,s,e){"use strict";var i=e(2);class n{constructor(t,s){this.position=new i.a(t,s)}draw(t,s){s.color.goBlack(),s.circle(t,this.position,n.DEFAULT_WIDTH)}highlight(t,s){s.color.goRed(),s.dot(t,this.position,n.DEFAULT_WIDTH+5,!0,5),s.color.goGreen(),s.circle(t,this.position,n.DEFAULT_MOVEMENT_RANGE),s.color.goBlack()}}s.a=n,n.DEFAULT_WIDTH=12,n.DEFAULT_MOVEMENT_RANGE=100,n.DEFAULT_MOVEMENT_LINE_WIDTH=3},function(t,s,e){"use strict";class i{}s.a=i,i.point=new class{dist2d(t,s){const e=s.X-t.X,i=s.Y-t.Y;return Math.sqrt(Math.abs(e*e+i*i))}collide_circle(t,s,e){return!(this.dist2d(t,s)>e)}}},function(t,s,e){"use strict";s.a=class{constructor(t=5){this.limit=t,this.num_actions=0,this.num_actions=0}end(){return this.num_actions+=1,this.num_actions>=this.limit}next(){this.num_actions=0,this.turns+=1}}},function(t,s,e){"use strict";s.a=class{constructor(t,s){this.valid_position=!1,this.id=t,this.position=s}};s.b=class{constructor(){this.active=new i,this.next=new i}};class i{constructor(){this.resource=null,this.accessed=!1}set(t){this.resource=t,this.accessed=!1}available(){return!this.accessed&&null!==this.resource}get(){if(this.accessed)throw new Error("This single access object has already been accessed.");{const t=this.resource;return this.resource=null,t}}}},function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e(8),n=e(9);window.Controls=i.a;var o="tanks-canvas";new n.a(o).setDOMResolution(window.innerWidth-32,.9*window.innerHeight)},function(t,s,e){"use strict";s.a=class{static toggle_w3_show(t){-1==t.className.indexOf("w3-show")?t.className+=" w3-show":t.className=t.className.replace(" w3-show","")}static w3_open(){document.getElementById("mySidebar").style.display="block",document.getElementById("myOverlay").style.display="block"}static w3_close(){document.getElementById("mySidebar").style.display="none",document.getElementById("myOverlay").style.display="none"}}},function(t,s,e){"use strict";var i=e(0);s.a=class{constructor(t){this.canvas=document.getElementById(t),this.events=new i.a(this.canvas,this.canvas.getContext("2d"))}showEvent(t,s,e){document.getElementById("debug-status").innerHTML=s+"times: "+e,event.preventDefault()}setDOMResolution(t,s){this.canvas.width=t,this.canvas.height=s}}},function(t,s,e){"use strict";var i=e(1),n=e(11),o=e(5),a=e(0),r=e(2),h=e(3);s.a=class{constructor(t,s,e){this.startMovement=(t=>{this.draw.last=new r.a(this.active.position.X,this.active.position.Y),this.draw.state=i.b.DRAWING,this.line.in(this.active.position,this.draw.mouse)&&this.validMove()}),this.endMovement=(t=>{this.draw.state=i.b.STOPPED,this.line.reset(),this.active.valid_position&&(this.player.tanks[this.active.id].position=this.draw.mouse.copy(),this.showUserWarning("")),this.redraw(this.player.tanks),this.controller.shared.next.set(a.b.TANK_MOVING),this.controller.changeGameState(a.b.TANK_SELECTION)}),this.drawMoveLine=(t=>{this.draw.updateMousePosition(t),this.draw.state==i.b.DRAWING&&(this.line.in(this.active.position,this.draw.mouse)?this.validMove():this.active.valid_position=!1)}),this.controller=t,this.context=s,this.player=e,this.draw=new i.a,this.line=new n.a(h.a.DEFAULT_MOVEMENT_RANGE),this.turn=new o.a,this.active=this.controller.shared.active.get()}addEventListeners(t){t.onmousedown=this.startMovement,t.onmousemove=this.drawMoveLine,window.onmouseup=this.endMovement}showUserWarning(t){document.getElementById("user-warning").innerHTML=t}validMove(){this.active.valid_position=!0,this.draw.line(this.context,h.a.DEFAULT_MOVEMENT_LINE_WIDTH)}redraw(t){this.controller.clearCanvas();for(const s of t)s.draw(this.context,this.draw)}}},function(t,s,e){"use strict";var i=e(4);s.a=class{constructor(t=200){this.limit=t,this.current=0}reset(){this.current=0}add(t,s){return this.current+=i.a.point.dist2d(t,s),this.current<=this.limit}in(t,s){return i.a.point.dist2d(t,s)<=this.limit}}},function(t,s,e){"use strict";var i=e(0),n=e(3),o=e(1),a=e(5);s.a=class{constructor(t,s,e){this.addTank=(t=>{this.draw.updateMousePosition(t);const s=new n.a(this.draw.mouse.X,this.draw.mouse.Y);s.player=this.player,this.player.tanks.push(s),s.draw(this.context,this.draw),this.turn.end()&&(this.controller.shared.next.set(i.b.TANK_MOVING),this.controller.changeGameState(i.b.TANK_SELECTION))}),this.controller=t,this.context=s,this.draw=new o.a,this.turn=new a.a,this.player=e}addEventListeners(t){t.onmousedown=this.addTank}}},function(t,s,e){"use strict";var i=e(0);s.a=class{constructor(t,s){this.someFunc=(()=>{console.log("Changing state from TANK SHOOTING to MENU"),this.controller.changeGameState(i.b.MENU)}),console.log("Initialising TANK SHOOTING"),this.controller=t,this.context=s}addEventListeners(t){t.addEventListener("mousedown",this.someFunc,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.someFunc,!1)}}},function(t,s,e){"use strict";var i=e(4),n=e(1),o=e(3),a=e(6);s.a=class{constructor(t,s,e){this.highlightTank=(t=>{this.draw.updateMousePosition(t);for(const[t,s]of this.player.tanks.entries())if(i.a.point.collide_circle(this.draw.mouse,s.position,o.a.DEFAULT_WIDTH)){s.highlight(this.context,this.draw),this.controller.shared.active.set(new a.a(t,s.position));break}}),this.mouseUp=(t=>{this.controller.shared.active.available()&&this.controller.changeGameState(this.controller.shared.next.get())}),this.controller=t,this.context=s,this.player=e,this.draw=new n.a}addEventListeners(t){t.onmousedown=this.highlightTank,window.onmouseup=this.mouseUp}}},function(t,s,e){"use strict";var i=e(0),n=e(1);class o{constructor(t,s){this.start_height=150,this.height_increment=100,this.title=t,this.options=s}draw(t,s){const e=t.canvas.width,i=t.canvas.height;t.fillStyle="Black",t.fillRect(0,0,e,i),t.textAlign="center",t.fillStyle="rgb(135,206,250)",t.font="60px Georgia";let n=this.start_height;t.fillText(this.title,e/2,n),t.fillStyle="White",t.font="30px Georgia",n+=this.height_increment;for(const[s,i]of this.options.entries())this.selected(s)?(t.fillStyle="Yellow",t.font="40px Georgia"):(t.fillStyle="White",t.font="30px Georgia"),t.fillText(i,e/2,n),n+=this.height_increment}selected(t){return this.selected_item===t}}s.a=class{constructor(t,s){this.selectMenuitem=(t=>{this.draw.updateMousePosition(t)}),this.someFunc=(t=>{console.log("Changing state from MENU EVENT to TANK PLACING"),this.controller.clearCanvas(),this.controller.changeGameState(i.b.TANK_PLACING)}),this.controller=t,this.context=s,this.draw=new n.a,this.menu=new o("Tanks",["Start game"]),this.menu.draw(this.context,this.draw)}addEventListeners(t){t.onmousedown=this.someFunc,t.onmousemove=this.selectMenuitem}}},function(t,s,e){"use strict";s.a=class{constructor(){this.tanks=new Array}}}]);