!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=6)}([function(t,e,s){"use strict";s.d(e,"b",function(){return i});var i,n=s(9),o=s(11),a=s(12),r=s(13),h=s(14);!function(t){t[t.MENU=0]="MENU",t[t.TANK_PLACING=1]="TANK_PLACING",t[t.TANK_MOVING=2]="TANK_MOVING",t[t.TANK_SHOOTING=3]="TANK_SHOOTING"}(i||(i={}));e.a=class{constructor(t,e){this.canvas=t,this.context=e,this.game_event=new r.a(this,this.context),this.game_event.addEventListeners(this.canvas),this.player=new h.a}changeGameState(t){switch(this.state=t,this.game_event.removeEventListeners(this.canvas),t){case i.MENU:this.game_event=new r.a(this,this.context),this.game_event.addEventListeners(this.canvas);break;case i.TANK_PLACING:this.game_event=new o.a(this,this.context,this.player),this.game_event.addEventListeners(this.canvas);break;case i.TANK_MOVING:this.game_event=new n.a(this,this.context,this.player),this.game_event.addEventListeners(this.canvas);break;case i.TANK_SHOOTING:this.game_event=new a.a(this,this.context),this.game_event.addEventListeners(this.canvas);break;default:throw new Error("The game should never be stateless, something has gone terribly wrong")}}}},function(t,e,s){"use strict";class i{constructor(t=-1,e=-1){this.X=t,this.Y=e}copy(){return new i(this.X,this.Y)}}e.a=i},function(t,e,s){"use strict";s.d(e,"b",function(){return i});var i,n=s(1);class o{constructor(){this.red=0,this.green=0,this.blue=0,this.alpha=1}toRGB(){return"rgb("+this.red+","+this.green+","+this.blue+")"}toRGBA(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"}set(t,e,s){this.red=t,this.green=e,this.blue=s}goRed(){this.set(255,0,0)}goGreen(){this.set(0,255,0)}goBlue(){this.set(0,0,255)}goWhite(){this.set(255,255,255)}next(){0!=this.red?this.goGreen():0!=this.green?this.goBlue():(this.blue,this.goRed())}}e.a=class{constructor(t=1){this.mouse=new n.a,this.last=new n.a,this.color=new o,this.width=t}dot(t,e,s,i=!1,n=1){this.color.goRed(),t.fillStyle=this.color.toRGBA(),t.beginPath(),t.arc(e.X,e.Y,s,0,2*Math.PI,!0),t.closePath(),t.fill(),this.color.goGreen(),i&&(t.lineWidth=n,t.strokeStyle=this.color.toRGBA(),t.stroke())}line(t,e=!0){-1==this.last.X&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y),t.strokeStyle=this.color.toRGBA(),t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(this.last.X,this.last.Y),t.lineTo(this.mouse.X,this.mouse.Y),t.lineWidth=this.width,t.stroke(),t.closePath(),e&&(this.last.X=this.mouse.X,this.last.Y=this.mouse.Y)}updateMousePosition(t){t||(t=event),t.offsetX&&(this.mouse.X=t.offsetX,this.mouse.Y=t.offsetY)}updateTouchPosition(t){if(t||(t=event),t.touches&&1==t.touches.length){const e=t.touches[0];this.mouse.X=e.pageX-e.target.offsetLeft,this.mouse.Y=e.pageY-e.target.offsetTop}}},function(t){t[t.DRAWING=0]="DRAWING",t[t.STOPPED=1]="STOPPED"}(i||(i={}))},function(t,e,s){"use strict";class i{}e.a=i,i.point=new class{dist2d(t,e){const s=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(Math.abs(s*s+i*i))}collide_circle(t,e,s){return!(this.dist2d(t,e)>s)}}},function(t,e,s){"use strict";e.a=class{constructor(t=5){this.limit=t,this.num_actions=0,this.num_actions=0}action(){return this.num_actions+=1,this.num_actions<this.limit}next(){this.num_actions=0,this.turns+=1}}},function(t,e,s){"use strict";var i=s(1);class n{constructor(t,e,s){this.position=new i.a(t,e),this.width=s}}e.a=n,n.DEFAULT_WIDTH=12},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(7),n=s(8);window.Controls=i.a;var o="tanks-canvas";new n.a(o).setDOMResolution(window.innerWidth-32,.9*window.innerHeight)},function(t,e,s){"use strict";e.a=class{static toggle_w3_show(t){-1==t.className.indexOf("w3-show")?t.className+=" w3-show":t.className=t.className.replace(" w3-show","")}static w3_open(){document.getElementById("mySidebar").style.display="block",document.getElementById("myOverlay").style.display="block"}static w3_close(){document.getElementById("mySidebar").style.display="none",document.getElementById("myOverlay").style.display="none"}}},function(t,e,s){"use strict";var i=s(0);e.a=class{constructor(t){this.canvas=document.getElementById(t),this.events=new i.a(this.canvas,this.canvas.getContext("2d"))}showEvent(t,e,s){document.getElementById("debug-status").innerHTML=e+"times: "+s,event.preventDefault()}setDOMResolution(t,e){this.canvas.width=t,this.canvas.height=e}}},function(t,e,s){"use strict";var i,n=s(2),o=s(10),a=s(4),r=s(3),h=s(1),c=s(5);class u{constructor(t,e){this.valid_position=!0,this.id=t,this.position=e}}!function(t){t[t.TANK_SELECTION=0]="TANK_SELECTION",t[t.TANK_MOVEMENT=1]="TANK_MOVEMENT"}(i||(i={}));e.a=class{constructor(t,e,s){this.mouseDown=(t=>{switch(this.state){case i.TANK_SELECTION:this.highlightTank(t);break;case i.TANK_MOVEMENT:this.moveTank(t)}}),this.mouseUp=(t=>{switch(this.draw.state=n.b.STOPPED,this.line.reset(),this.state){case i.TANK_SELECTION:this.draw.last.X=-1,this.draw.last.Y=-1,this.active&&(this.state=i.TANK_MOVEMENT);break;case i.TANK_MOVEMENT:this.state=i.TANK_SELECTION,this.active.valid_position&&(this.draw.dot(this.context,this.draw.mouse,c.a.DEFAULT_WIDTH),this.player.tanks[this.active.id].position=this.draw.mouse.copy()),this.active=null}}),this.mouseMove=(t=>{this.draw.updateMousePosition(t),this.draw.state==n.b.DRAWING&&(this.line.in(this.active.position,this.draw.mouse)?(this.active.valid_position=!0,this.draw.line(this.context)):this.active.valid_position=!1)}),this.touchMove=(t=>{this.draw.updateTouchPosition(t),this.draw.line(this.context),event.preventDefault()}),this.penMove=(t=>{this.draw.updateMousePosition(t),this.draw.state==n.b.DRAWING&&this.draw.line(this.context),event.preventDefault()}),this.controller=t,this.context=e,this.draw=new n.a,this.line=new o.a,this.turn=new a.a,this.player=s,this.state=i.TANK_SELECTION}addEventListeners(t){t.addEventListener("mousedown",this.mouseDown,!1),t.addEventListener("mousemove",this.mouseMove,!1),window.addEventListener("mouseup",this.mouseUp,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.mouseDown,!1),t.removeEventListener("mousemove",this.mouseMove,!1),window.removeEventListener("mouseup",this.mouseUp,!1)}highlightTank(t){this.draw.updateMousePosition(t);for(const[t,e]of this.player.tanks.entries())if(r.a.point.collide_circle(this.draw.mouse,e.position,e.width)){this.draw.dot(this.context,e.position,e.width+5,!0,5),this.active=new u(t,e.position);break}}moveTank(t){this.draw.last=new h.a(this.active.position.X,this.active.position.Y),this.draw.state=n.b.DRAWING,this.line.in(this.active.position,this.draw.mouse)?this.draw.line(this.context):document.getElementById("user-warning").innerHTML="Trying to move too far!"}}},function(t,e,s){"use strict";var i=s(3);e.a=class{constructor(t=200){this.limit=t,this.current=0}reset(){this.current=0}add(t,e){return this.current+=i.a.point.dist2d(t,e),this.current<=this.limit}in(t,e){const s=i.a.point.dist2d(t,e);return console.log("Distance between points: ",s),s<=this.limit}}},function(t,e,s){"use strict";var i=s(0),n=s(5),o=s(2),a=s(4);e.a=class{constructor(t,e,s){this.addTank=(t=>{this.draw.updateMousePosition(t),this.player.tanks.push(new n.a(this.draw.mouse.X,this.draw.mouse.Y,n.a.DEFAULT_WIDTH)),this.draw.dot(this.context,this.draw.mouse,n.a.DEFAULT_WIDTH),this.turn.action()||this.controller.changeGameState(i.b.TANK_MOVING)}),console.log("Initialising TANK PLACING"),this.controller=t,this.context=e,this.draw=new o.a(12),this.turn=new a.a,this.player=s}addEventListeners(t){t.addEventListener("mousedown",this.addTank,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.addTank,!1)}}},function(t,e,s){"use strict";var i=s(0);e.a=class{constructor(t,e){this.someFunc=(()=>{console.log("Changing state from TANK SHOOTING to MENU"),this.controller.changeGameState(i.b.MENU)}),console.log("Initialising TANK SHOOTING"),this.controller=t,this.context=e}addEventListeners(t){t.addEventListener("mousedown",this.someFunc,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.someFunc,!1)}}},function(t,e,s){"use strict";var i=s(0);e.a=class{constructor(t,e){this.someFunc=(()=>{console.log("Changing state from MENU EVENT to TANK PLACING"),this.controller.changeGameState(i.b.TANK_PLACING)}),console.log("Initialising MENU EVENT"),this.controller=t,this.context=e}addEventListeners(t){t.addEventListener("mousedown",this.someFunc,!1)}removeEventListeners(t){t.removeEventListener("mousedown",this.someFunc,!1)}}},function(t,e,s){"use strict";e.a=class{constructor(){this.tanks=new Array}}}]);